<!DOCTYPE html>
<html lang="en" style="font-family: monospace;"><head><title>[32b030b51b] move more stuff into Make targets | gorts | Boast</title><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"></head><body><strong><a href="../../">Repos</a> / <a href="../">gorts</a> / 32b030b51b</strong><hr><pre>commit 32b030b51b4d3f15dd4b96f6d7a0700871aed3f8
Author: Nh√¢n &lt;hi@imnhan.com&gt;
Date:   Mon Jun 19 00:10:42 2023 +0700

    move more stuff into Make targets
    
    ... preparing to build &amp; release via github actions too,
    because downloading from sr.ht is soooo slow at times.

diff --git a/.builds/alpine.yml b/.builds/alpine.yml
index 9af1e13..5b8a4b8 100644
--- a/.builds/alpine.yml
+++ b/.builds/alpine.yml
@@ -14,16 +14,11 @@ packages:
 tasks:
   - make-linux: |
       cd gorts
-      make dist-linux
-      cd dist/linux
-      zip -r ../GORTS-Linux.zip .
+      make dist/GORTS-Linux.zip
 
   - make-windows: |
       cd gorts
-      make dist-windows
-      cd dist/windows
-      curl -L &#39;https://tclkits.rkeene.org/fossil/raw/tclkit-8.6.3-win32-x86_64.exe?name=403c507437d0b10035c7839f22f5bb806ec1f491&#39; &gt; tclkit.exe
-      zip -r ../GORTS-Windows.zip .
+      make dist/GORTS-Windows.zip
 
   - check-tag: |
       # Stop if HEAD is not a tagged commit.
diff --git a/Makefile b/Makefile
index 30dd7c8..9419560 100644
--- a/Makefile
+++ b/Makefile
@@ -9,6 +9,14 @@ dist-windows:
 		go build -o dist/windows/gorts.exe -ldflags -H=windowsgui
 	cp -r web dist/windows/web
 
+dist/GORTS-Linux.zip: dist-linux
+	cd dist/linux; zip -r ../GORTS-Linux.zip .
+
+dist/GORTS-Windows.zip: dist-windows
+	cd dist/windows; \
+		curl -L &#39;https://tclkits.rkeene.org/fossil/raw/tclkit-8.6.3-win32-x86_64.exe?name=403c507437d0b10035c7839f22f5bb806ec1f491&#39; &gt; tclkit.exe; \
+		zip -r ../GORTS-Windows.zip .
+
 gorts.png: gorts.svg
 	convert -background transparent -density 300 -resize 256x256 gorts.svg gorts.png
 
</pre></body></html>