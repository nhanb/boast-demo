<!DOCTYPE html>
<html lang="en" style="font-family: monospace;"><head><title>[faef51c459] show mangasee titles first | pytaku | Boast</title><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"></head><body><strong><a href="../../">Repos</a> / <a href="../">pytaku</a> / faef51c459</strong><hr><pre>commit faef51c459c0938c5686f458be54ac04722fc63e
Author: Bùi Thành Nhân &lt;hi@imnhan.com&gt;
Date:   Sun May 23 00:36:45 2021 +0700

    show mangasee titles first
    
    Stopgap measure until I actually implement the new mangadex API.

diff --git a/src/pytaku/persistence.py b/src/pytaku/persistence.py
index 3747a16..0144cbf 100644
--- a/src/pytaku/persistence.py
+++ b/src/pytaku/persistence.py
@@ -272,7 +272,16 @@ def get_followed_titles(user_id):
 
         t[&quot;chapters&quot;] = chapters
 
-    return sorted(titles, key=lambda t: len(t[&quot;chapters&quot;]), reverse=True)
+    def sort_key_func(title):
+        &quot;&quot;&quot;
+        Prioritize titles that:
+        - Have unread chapters
+        - Are from mangasee (because mangadex is currently broken)
+        &quot;&quot;&quot;
+        has_chapters = 1 if len(title[&quot;chapters&quot;]) &gt; 0 else 0
+        return (has_chapters, title[&quot;site&quot;])
+
+    return sorted(titles, key=sort_key_func, reverse=True)
 
 
 def read(user_id, site, title_id, chapter_id):
</pre></body></html>