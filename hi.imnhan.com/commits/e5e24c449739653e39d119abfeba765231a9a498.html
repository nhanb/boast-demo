<!DOCTYPE html>
<html lang="en" style="font-family: monospace;"><head><title>[e5e24c4497] node-webkit tutorial | hi.imnhan.com | Boast</title><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"></head><body><strong><a href="../../">Repos</a> / <a href="../">hi.imnhan.com</a> / e5e24c4497</strong><hr><pre>commit e5e24c449739653e39d119abfeba765231a9a498
Author: nhanb &lt;thanhnhan483@gmail.com&gt;
Date:   Thu May 1 12:23:05 2014 +0700

    node-webkit tutorial

diff --git a/content/images/nw_xp.png b/content/images/nw_xp.png
new file mode 100644
index 0000000..8e5e70c
Binary files /dev/null and b/content/images/nw_xp.png differ
diff --git a/content/set-up-node-webkit-development-environment.md b/content/set-up-node-webkit-development-environment.md
new file mode 100644
index 0000000..453b671
--- /dev/null
+++ b/content/set-up-node-webkit-development-environment.md
@@ -0,0 +1,252 @@
+Title: Setting up your development environment for a node-webkit project
+Date: 2014-05-01 08:23
+Category: tutorials
+Tags: linux, webdev
+Slug: setting-up-your-development-environment-for-a-node-webkit-project
+
+![](/images/nw_xp.png &quot;XP support y&#39;all!&quot;)
+
+[Node-webkit][1] lets you write cross-platform (Mac + Linux + Winbloze) desktop applications using
+HTML5 and nodejs. That&#39;s a fancy way of saying &quot;a webkit wrapper that also gives you filesystem
+access, disables same-origin policy and has nodejs embedded&quot;. It&#39;s the lazy web developers&#39; dream
+come true. Who needs Qt, GTK, or any other legitimate battle-tested, performant cross-platform GUI
+toolkit when you can slap in Bootstrap/Foundation with some hip JavaScript framework instead?
+
+Joking aside, this is an interesting take on desktop development. Firefox OS is on the horizon, and
+even Ubuntu is pushing the &quot;HTML5 apps as first-class citizens&quot; paradigm. Why not give it a try?
+
+If you already have experience in client-side web development tools, you can just clone
+[node-webkit-hipster-seed][2] and digest the code. That&#39;s a project skeleton that integrates all
+kinds of stuff: Jade/Coffescript/LESS automatic compiler, node-webkit, grunt tasks...
+
+This tutorial is like a stripped down version of that. In the end we&#39;ll have:
+
+- Automatic app reload when source code changes with `livereload`
+- Single command to build binaries for mac + linux + win with `grunt`
+- That&#39;s it, really
+
+## Install node-webkit on your machine
+
+Follow the README on [node-webkit&#39;s GitHub page][1] to download a precompiled `nw` binary for your
+platform. If you&#39;re using Arch Linux, you&#39;re in luck since there&#39;s already an AUR package:
+
+    :::bash
+    $ yaourt -S node-webkit
+
+If you&#39;re on Ubuntu or some other repo and you get some error about `libudev.so.0`, [read this][3]
+for a hotfix.
+
+The rest of this tutorial will assume that you have `nw` accessible as an executable in your $PATH.
+
+## Running an app
+
+First, take a look at nw&#39;s [quickstart guide][4]. We&#39;ll make a somewhat different structure,
+allowing the **dist** directory to store our binary releases:
+
+    :::
+    ├── app/
+    │  ├── css/
+    │  ├── js/
+    │  ├── index.html
+    │  └── package.json
+    └── dist/
+
+**package.json** stores the information that `nw` requires. Its content goes like this:
+
+    :::json
+    {
+      &quot;name&quot;: &quot;your-project-name&quot;,
+      &quot;version&quot;: &quot;0.0.1&quot;,
+      &quot;main&quot;: &quot;index.html&quot;,
+      &quot;window&quot;: {
+          &quot;toolbar&quot;: true
+      }
+    }
+
+`window.toolbar` is `true` by default so we don&#39;t actually need it. Switch it to `false` if you
+want to hide the browser-like address bar.
+
+To embed css/js files, don&#39;t use absolute urls. Use relative ones like this:
+
+    :::html
+    &lt;link href=&quot;css/style.css&quot; rel=&quot;stylesheet&quot;&gt;
+
+There&#39;s no point in using CDNs because we&#39;re distributing the whole app with its assets as a
+one-time download. Things like automatic css/js minification or concatination aren&#39;t needed either.
+For simplicity&#39;s sake, we&#39;ll just download a minified version of whatever js/css library that we
+need and stuff them into **css** or **js** dir. For example: (**dist** directory omitted)
+
+    :::
+    app/
+    ├── css
+    │   └── bootstrap.min.css
+    ├── js
+    │   ├── bootstrap.min.js
+    │   ├── knockout.min.js
+    │   ├── jquery.min.js
+    │   └── app.js
+    ├── index.html
+    └── package.json
+
+If you&#39;re experienced in front-end web development tools, feel free to go wild with bower,
+grunt/gulp/whatever. Again, check out the [node-webkit-hipster-seed][2] project if you know what
+you&#39;re doing.
+
+You can now test run your app with the `nw &lt;directory&gt;` command. In our case: `nw app`. Notice the
+weird url, which is why we can&#39;t use absolute urls in the first place:
+
+    :::
+    file:///home/nhanb/Dropbox/small_projects/ajmg-nw/app/index.html
+
+Once you&#39;ve packaged your app to a single executable, the url will be something like this:
+
+    :::
+    file:///tmp/.org.chromium.Chromium.IJWqkq/index.html
+
+But let&#39;s not get ahead of ourselves. Let&#39;s solve the most obvious dev issue first:
+
+## Automatic reload
+
+Sure enough, at first glance your app is just another html page. You may be tempted to run some
+simple http server and open localhost in Google Chrome (`python2 -m SimpleHTTPServer 8080`
+anyone?). There are tons of ways to make Google Chrome automatically reload a page, right?
+
+But then, the true strength of `node-webkit` is the ability to use nodejs modules, which Google
+Chrome certainly doesn&#39;t offer. Therefore, the only way to check out how the app really works is
+using `nw app`.
+
+We&#39;ll use `livereload` to make automatic reloading possible. The idea is quite simple: we fire off
+a `livereload` daemon that watches for any change in our **app/** directory. In our app, we embed a
+certain piece of javascript that connects to that `livereload` daemon and refreshes the page
+whenever a &quot;change&quot; event is broadcast.
+
+There are many `livereload` daemon implementations. Considering the fact that most of us developers
+have python and pip installed, let&#39;s go with the `livereload` pip package (it&#39;s only compatible
+with python2, by the way). If you&#39;re on Ubuntu and don&#39;t know what I&#39;m talking about:
+
+    :::bash
+    $ sudo apt-get install python-pip
+    $ sudo pip install livereload
+
+There are ruby/javascript implementations too. Google them if you prefer those things.
+
+Either way, we can now fire off a livereload server:
+
+    :::
+    # I don&#39;t know why but seems like the python implementation doesn&#39;t work
+    # when I type `livereload app`. Weird.
+    $ cd app
+    $ livereload .
+
+Now how do we inject the livereload javascript? On Google Chrome there is an official livereload
+plugin, but we&#39;re using node-webkit so that&#39;s not possible. No problem! The `livereload` daemon we
+fired off earlier is actually a web server which also serves the necessary livereload client
+JavaScript snippet too. Simply embed it to your **index.html**:
+
+    :::html
+    &lt;script src=&quot;http://localhost:35729/livereload.js&quot;&gt;&lt;/script&gt;
+
+Fire off the app with `nw app` again and you&#39;ll have automatic reloading. Cool eh?
+
+Another problem: we only want livereload in our development version, not in the released app. Let&#39;s
+modify our javascript snippet in **index.html** to only load livereload when a certain environment
+variable is set to `1`:
+
+    :::html
+    &lt;script&gt;
+    // Load livereload if in dev environment
+    if (process.env.NW_DEV_MY_AWESOME_PROJECT == 1) {
+        var script = document.createElement(&#39;script&#39;);
+        script.type = &#39;text/javascript&#39;;
+        script.src = &#39;http://localhost:35729/livereload.js&#39;;
+        document.body.appendChild(script);
+    }
+    &lt;/script&gt;
+
+Now to start the app:
+
+    :::bash
+    $ export NW_DEV_MY_AWESOME_PROJECT=1
+    $ nw app
+
+## Simple cross-platform build command
+
+To be honest, you can manually write shell scripts to build for each platform. Check out [this wiki
+article][5] if you prefer the do-it-yourself way.
+
+But if you&#39;re lazy (like me) and don&#39;t have a problem using nodejs/grunt, just use the excellent
+[grunt-node-webkit-builder][6]. Again, for newcomers using Ubuntu:
+
+    :::bash
+    $ sudo add-apt-repository ppa:chris-lea/node.js
+    $ sudo apt-get update
+    $ sudo apt-get install python-software-properties python g++ make nodejs
+    $ sudo npm install -g grunt-cli
+    $ # cd to your project root (the one containing app/ and dist/)
+
+Create `package.json` and `Gruntfile.js` in project root:
+
+    ├── app/
+    │   ├── css/
+    │   ├── js/
+    │   ├── index.html
+    │   └── package.json
+    ├── dist/
+    ├── Gruntfile.js
+    └── package.json
+
+**package.json**:
+
+    :::json
+    {
+      &quot;name&quot;: &quot;whatever&quot;,
+      &quot;version&quot;: &quot;0.0.1&quot;,
+      &quot;description&quot;: &quot;Whatever&quot;,
+      &quot;author&quot;: &quot;Bui Thanh Nhan&quot;
+    }
+
+**Gruntfile.js**:
+
+    :::js
+    module.exports = function(grunt) {
+        grunt.initConfig({
+            pkg: grunt.file.readJSON(&#39;package.json&#39;),
+            nodewebkit: {
+                options: {
+                    build_dir: &#39;./dist&#39;,
+                    // choose what platforms to compile for here
+                    mac: true,
+                    win: true,
+                    linux32: true,
+                    linux64: true
+                },
+                src: [&#39;./app/**/*&#39;]
+            }
+        })
+
+        grunt.loadNpmTasks(&#39;grunt-node-webkit-builder&#39;);
+        grunt.registerTask(&#39;default&#39;, [&#39;nodewebkit&#39;]);
+    };
+
+Then:
+
+    :::bash
+    $ npm install grunt grunt-node-webkit-builder --save-dev
+    $ grunt
+
+The first time will be slow because grunt will download precompiled nw binaries for all supported
+platforms, which will be stored in **dist/cache/**. From now you can compile for mac + linux + win
+with a simple `grunt` command. The compiled binaries will be stored in **dist/releases/**.
+
+Congratulations! You now know how to use yet another weird stack born out of the HTML5 craze that
+isn&#39;t guaranteed to still be alive the next year (or even next month). For extra credit, use it to
+piss off long-time UNIX Philosophy believers. The [suckless][7] community would be a good place to
+start. ;)
+
+[1]: https://github.com/rogerwang/node-webkit
+[2]: https://github.com/Anonyfox/node-webkit-hipster-seed
+[3]: http://www.exponential.io/blog/install-node-webkit-on-ubuntu-linux
+[4]: https://github.com/rogerwang/node-webkit#quick-start
+[5]: https://github.com/rogerwang/node-webkit/wiki/How-to-package-and-distribute-your-apps
+[6]: https://github.com/mllrsohn/grunt-node-webkit-builder
+[7]: http://suckless.org/philosophy
</pre></body></html>