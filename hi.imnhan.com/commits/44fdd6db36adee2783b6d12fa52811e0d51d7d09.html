<!DOCTYPE html>
<html lang="en" style="font-family: monospace;"><head><title>[44fdd6db36] add note on sql injection | hi.imnhan.com | Boast</title><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"></head><body><strong><a href="../../">Repos</a> / <a href="../">hi.imnhan.com</a> / 44fdd6db36</strong><hr><pre>commit 44fdd6db36adee2783b6d12fa52811e0d51d7d09
Author: Bùi Thành Nhân &lt;hi@imnhan.com&gt;
Date:   Mon Jan 31 09:28:10 2022 +0700

    add note on sql injection

diff --git a/content/posts/working-with-sqlite-without-an-orm.md b/content/posts/working-with-sqlite-without-an-orm.md
index 259d608..89b8b3f 100644
--- a/content/posts/working-with-sqlite-without-an-orm.md
+++ b/content/posts/working-with-sqlite-without-an-orm.md
@@ -138,7 +138,7 @@ ## A minimum viable DB migration scheme
 was already nicely warned against in the docs. RTMF is actually fine advice for
 projects that have good documentation, who would have thought?
 
-## Recommended &quot;sane&quot; defaults
+## Recommended sane defaults
 
 SQLite comes with some default settings that may be surprising for people
 coming from e.g. Postgres. Here are some tweaks that worked better for me.
@@ -156,6 +156,26 @@ ## Recommended &quot;sane&quot; defaults
 crash immediately instead of waiting for the blocking query to finish, no
 matter how short the wait is.
 
+## A quick note on SQL injection
+
+_(or how to move on from the late 90s)_
+
+You don&#39;t need a full blown ORM to protect yourself against SQL injections. In
+fact, SQLite (and any sane RDBMS really) has built-in support for it called
+parameterized queries. The python documentation also [covers this][17], but the
+tl;dr is:
+
+```python
+# Never compose your query with string interpolation like this:
+cursor.execute(f&quot;SELECT foo FROM bar WHERE stuff = &#39;{user_input}&#39;;&quot;)
+
+# Use the parameter substitution API instead:
+cursor.execute(&#39;SELECT foo FROM bar WHERE stuff = ?;&#39;, (user_input,))
+```
+
+Congratulations! You now have better security than [Vietnam&#39;s &quot;leading&quot;
+cybersecurity firm][16].
+
 [1]: https://news.ycombinator.com/item?id=23510382
 [2]: https://sr.ht/~nhanb/pytaku/
 [3]: https://code.djangoproject.com/ticket/21961
@@ -171,3 +191,5 @@ ## Recommended &quot;sane&quot; defaults
 [13]: https://www.sqlite.org/stricttables.html
 [14]: https://www.sqlite.org/c3ref/busy_timeout.html
 [15]: https://www.sqlite.org/lang_altertable.html#otheralter
+[16]: https://vnhacker.blogspot.com/2021/08/bkav-bi-hack-nhu-nao.html
+[17]: https://docs.python.org/3/library/sqlite3.html
</pre></body></html>