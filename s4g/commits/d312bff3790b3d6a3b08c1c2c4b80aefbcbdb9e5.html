<!DOCTYPE html>
<html lang="en" style="font-family: monospace;"><head><title>[d312bff379] more friendly defaults; abort on failure | s4g | Boast</title><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"></head><body><strong><a href="../../">Repos</a> / <a href="../">s4g</a> / d312bff379</strong><hr><pre>commit d312bff3790b3d6a3b08c1c2c4b80aefbcbdb9e5
Author: Nh√¢n &lt;hi@imnhan.com&gt;
Date:   Thu Aug 24 12:04:39 2023 +0700

    more friendly defaults; abort on failure

diff --git a/main.go b/main.go
index 1cb1428..7d42b67 100644
--- a/main.go
+++ b/main.go
@@ -80,14 +80,23 @@ func handleNewCmd(folder string) {
 }
 
 func handleServeCmd(folder, addr string) {
-	djot.StartService()
-	fmt.Println(&quot;Started djot.js service&quot;)
-
 	absolutePath, err := filepath.Abs(folder)
 	if err != nil {
 		panic(err)
 	}
 
+	finfo, err := os.Stat(filepath.Join(absolutePath, S4gDir))
+	if err != nil || !finfo.IsDir() {
+		fmt.Printf(
+			&quot;Error: %s doesn&#39;t have an %s folder\n&quot;,
+			absolutePath, S4gDir,
+		)
+		os.Exit(1)
+	}
+
+	djot.StartService()
+	fmt.Println(&quot;Started djot.js service&quot;)
+
 	fsys := writablefs.WriteDirFS(absolutePath)
 	site, err := ReadSiteMetadata(fsys)
 	if err != nil {
@@ -165,7 +174,10 @@ func runServer(fsys writablefs.FS, webRoot, addr string) *http.Server {
 	}
 
 	go func() {
-		srv.ListenAndServe()
+		err := srv.ListenAndServe()
+		if err != nil {
+			panic(err)
+		}
 	}()
 
 	return srv
diff --git a/metadata.go b/metadata.go
index fb90aee..15e4b16 100644
--- a/metadata.go
+++ b/metadata.go
@@ -83,10 +83,19 @@ type ArticleMetadata struct {
 
 func NewSiteMetadata() SiteMetadata {
 	return SiteMetadata{
-		Root:        &quot;/&quot;,
-		ShowFooter:  true,
-		FooterText:  `Made with &lt;a href=&quot;https://github.com/nhanb/s4g&quot;&gt;s4g&lt;/a&gt;`,
-		NavbarLinks: []string{&quot;index.dj&quot;},
+		Address:      &quot;http://example.com&quot;,
+		Name:         &quot;This is my website&quot;,
+		Tagline:      &quot;and it&#39;s fine&quot;,
+		Root:         &quot;/&quot;,
+		ShowFooter:   true,
+		FooterText:   `Made with &lt;a href=&quot;https://github.com/nhanb/s4g&quot;&gt;s4g&lt;/a&gt;`,
+		NavbarLinks:  []string{&quot;index.dj&quot;, &quot;#s4g#https://github.com/nhanb/s4g&quot;},
+		DefaultThumb: &quot;&quot;,
+
+		AuthorName:    &quot;Scoop Newsman&quot;,
+		AuthorURI:     &quot;https://example.com/scoop&quot;,
+		AuthorEmail:   &quot;scoopidoo@example.com&quot;,
+		AuthorTwitter: &quot;&quot;,
 	}
 }
 
</pre></body></html>