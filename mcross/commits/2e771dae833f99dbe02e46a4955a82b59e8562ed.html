<!DOCTYPE html>
<html lang="en" style="font-family: monospace;"><head><title>[2e771dae83] fix partial response bug | mcross | Boast</title><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"></head><body><strong><a href="../../">Repos</a> / <a href="../">mcross</a> / 2e771dae83</strong><hr><pre>commit 2e771dae833f99dbe02e46a4955a82b59e8562ed
Author: Bùi Thành Nhân &lt;hi@imnhan.com&gt;
Date:   Sat May 16 16:36:28 2020 +0700

    fix partial response bug
    
    hey I just touched tcp stuff like 2 days ago don&#39;t judge me

diff --git a/pyproject.toml b/pyproject.toml
index 2d80b51..9bd58a8 100644
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -1,6 +1,6 @@
 [tool.poetry]
 name = &quot;mcross&quot;
-version = &quot;0.4.2&quot;
+version = &quot;0.4.3&quot;
 description = &quot;Do you remember www?&quot;
 authors = [&quot;nhanb &lt;hi@imnhan.com&gt;&quot;]
 license = &quot;MIT&quot;
diff --git a/src/mcross/transport.py b/src/mcross/transport.py
index 0a74c05..8d1ff3f 100644
--- a/src/mcross/transport.py
+++ b/src/mcross/transport.py
@@ -118,7 +118,13 @@ def raw_get(url: GeminiUrl):
             resp = Response(status=status, meta=meta, url=url)
 
             if status.startswith(&quot;2&quot;):
-                resp.body = ssock.recv(MAX_RESP_BODY_BYTES)
+                body = b&quot;&quot;
+                msg = ssock.recv(4096)
+                body += msg
+                while msg and len(body) &lt;= MAX_RESP_BODY_BYTES:
+                    msg = ssock.recv(4096)
+                    body += msg
+                resp.body = body
 
             return resp
 
</pre></body></html>